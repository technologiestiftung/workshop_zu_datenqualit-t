---
title: "Workshop zu Datenqualität"
author: "City Lab Berlin"
date: "Datum (TBD)"
output:
  beamer_presentation:
    colortheme: seahorse
    theme: Hannover
  slidy_presentation: default
  ioslides_presentation: default
fontsize: 14pt
header-includes: \usepackage{graphicx} \usepackage{graphbox}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

options(tinytex.verbose = TRUE)
```

# Einführung

## Plan

1. **Theorie**

  + Was ist Datenqualität?
  + Relevanz von Datenqualität
  
2. **Praxis**

  + Datenqualität für Excel-Dateien
  + Datenqualität für CSV-Dateien
  + Excel vs. CSV: Welches sollte ich nutzen?
  + Andere Datenformate
  + Häufige Datenqualitäts-Probleme  

# 1. Theorie

## Was ist Datenqualität?

Wie bewertet man die Qualität eines Datensatzes?

- 2 Dimensionen:

  + Wie sind die Daten *aufbereitet*? 
  
  + Wie sind die Daten *bereitgestellt*?
  
## Was ist Datenqualität?

- Neben der Aufbereitung und Bereitstellung der Daten, kann man auch hinterfragen, wie die Daten tatsächlich erhoben wurden
<!-- zB: Gab es ein Bias oder einen systematischen Fehler bei der Erfassung der Daten? -->

  + Werden wir aber bei diesem Workshop nicht disktutieren
  
## Warum reden wir darüber?

\vspace{0.5cm}

- Datenqualität ist so wichtig weil: "Garbage in, garbage out"

  - Die Qualität des Inputs bestimmt die Qualität des Outputs!

\begin{center}
\includegraphics[width=0.45\textwidth]{images/pic3}
\end{center}

  
## Bewertung der Datenqualität
<!-- Diese Liste ist nicht unfassend, aber aus unserer Sicht stellen diese 3 Modelle die gängigsten Perspektiven auf Datenqualität dar -->
3 Beispiele von Heransgehenweisen:

1. FAIR-Prinzipe

2. 5-Sterne-Modell

3. NQDM Merkmale der Datenqualität

<!-- End of new slides added VB-->


## Bewertung der Datenqualität

1. **FAIR**

- FAIR-Data ist:
  
  + **F**indable (Auffindbar)
  
  + **A**ccessible (Zugänglich)
  
  + **I**nteroperable (Interoperabel)
  
  + **R**eusable (Wiederverwendbar)
  
\vspace{.5cm}  
  
\scriptsize\textbf{Quelle}: Wilkinson, M. D. et al. (2016)
  
  
## Bewertung der Datenqualität


- **Findable**: *Wo/wie sind die Daten auffindbar?*
  
  + Datensatz ist registriert oder indiziert (z.B.: in einem Datenportal)
    
  + Dauerhafte Bezeichnung (Stable ID)
    
  + Ausführliche Beschreibung des Inhalts
  
  \vspace{1.5cm}  
  
\scriptsize\textbf{Quelle}: Wilkinson, M. D. et al. (2016)

  
## Bewertung der Datenqualität

- **Accessible**: *Wie kann ich auf die Daten zugreifen?*
  
  + Klar und kostenlosen Zugriffsprotokoll
  
  + *Metadaten* (Beschreibung der Daten) und *Daten* (Inhalt) sind abrufbar
  
  + Metadaten sind **immer** verfügbar, auch wenn die Daten nicht mehr abrufbar sind
  
  \vspace{0.5cm}  
  
\scriptsize\textbf{Quelle}: Wilkinson, M. D. et al. (2016)
  
## Bewertung der Datenqualität

- **Interoperable**: *Wie leicht ist es, die Daten im Zusammenhang mit anderen Systemen oder Datensätzen zu verwenden?*
  
  + Formale und zugängliche Sprache
  
  + Verweise auf andere Daten
  
  + Mögliche Integration mit anderen Datensätzen
  
  \vspace{.5cm}  
  
\scriptsize\textbf{Quelle}: Wilkinson, M. D. et al. (2016)
  
## Bewertung der Datenqualität

- **Reusable**: *Wie kann ich diese Daten wiederverwenden?*

  + Detaillierter Herkunft: Wo kommen die Daten her? 
    
  + Verständliche Lizenzierung
  
  \vspace{1.5cm}  
  
\scriptsize\textbf{Quelle}: Wilkinson, M. D. et al. (2016)
  
## Bewertung der Datenqualität
  
2. **5-Sterne-Modell**
<!-- New content added to this slide VB -->

\begin{center}
\includegraphics[width=0.8\textwidth]{images/pic1}
\end{center}


## Bewertung der Datenqualität

\begin{center}
Daten im Web (ex.: PDF)

\includegraphics[width=0.1\textwidth]{images/arrow.png}


Daten in strukturiertem Format (ex.: XLS)
  

\includegraphics[width=0.1\textwidth]{images/arrow.png}


Daten in strukturiertem, nicht proprietärem Format (ex.: CSV)

\end{center}
  
## Bewertung der Datenqualität


\begin{center}

\includegraphics[width=0.1\textwidth]{images/arrow.png}

Verwendung von eindeutigen URLs (ex.: RDF)

\includegraphics[width=0.1\textwidth]{images/arrow.png}

Verlinkung der eigenen Daten mit anderen Daten (ex.: LOD)

\end{center}

## Bewertung der Datenqualität
<!-- New content added to this slide VB -->

3. **Merkmale der Datenqualität** aus dem "Normentwurf für qualitativ hochwertige Daten und Metadaten" (NQDM, Fraunhofer FOKUS)

## Bewertung der Datenqualität

- Liste von Merkmalen der Datenqualität:
<!-- This may need to be pushed to a second slide? -->

  + Aktualität
  + Fehlerfreiheit
  + Genauigkeit
  + Konformität
  + Konsistenz
  + Transparenz & Vertrauenswürdigkeit
  + Verlässlichkeit
  + Verständlichkeit 
  + Vollständigkeit
  + Zugänglichkeit & Verfügbarkeit

\scriptsize\textbf{Quelle}: "Leitfaden für qualitativ hochwertige Daten und Metadaten", Fraunhofer FOKUS/NQDM, S. 14. https://www.nqdm-projekt.de/de/downloads/leitfaden


<!-- ## Datenqualität definieren  -->
<!-- Delete? VB --> 

<!-- - **Diskussion** -->

<!--   + Die Datenqualität kann anhand verschiedener Standards definiert werden -->

<!--   + Metadaten sind genauso wichtig wie die Daten selbst -->

<!--   + Es gibt wichtige Prinzipe und Leitlinien... aber manchmal sind die nicht spezifisch genug! -->

<!-- ## Relevanz von Datenqualität -->

<!-- ### Schritte der Datenqualität -->
<!-- Delete this slide? VB -->


<!-- + Drei Schritte, von denen die Datenqualität abhängt: -->

<!--   1. **Data Generating Process** -->
<!--       - Wie werden die Daten gesammelt? -->


<!--   2. **Data Cleaning** -->
<!--       - Wie sind die Datensatzdatei erstellt? -->


<!--   3. **Data Publishing** -->
<!--        - Wie ist der Datensatz veröffentlicht? -->

<!-- + Diese Schritte sind voneinander abhängig -->

# *Quiz*

## Datensatz von Berlin Open Data

+ **Schulbausanierung Sommer 2020**

    + https://daten.berlin.de/datensaetze/schulbausanierung-sommer-2020

## Schulbausanierung Sommer 2020

\begin{center}
\includegraphics[width=0.9\textwidth]{images/pic4}
\end{center}

## Fragen

- Wie gut ist diesen Datensatz bezüglich der FAIR-Prinzipien?

  + **Findable**: *Wo finde ich die Daten?*
  + **Accessible**: *Wie kann ich auf die Daten zugreifen?*
  + **Interoperable**: *Wie leicht ist es, diese Daten zu verwenden?*
  + **Reusable**: *Weiß ich, wie ich diese Daten wiedeerverwenden kann/darf?*

- Wie optimal ist das Datenformat?


## Analyse


- **Findable**: *Wo finde ich die Daten?*

\includegraphics[align=c,width=.05\textwidth]{images/check} \textcolor{green}{\textbf{Datensatz registriert oder indiziert}}

\includegraphics[align=c,width=.05\textwidth]{images/wrong} \textcolor{red}{\textbf{Dauerhafte Identifikationsnummer}}

\includegraphics[align=c,width=.05\textwidth]{images/wavy} \textcolor{orange}{\textbf{Ausführliche Beschreibung}}

##  Analyse

- **Accessible**: *Wie kann ich auf die Daten zugreifen?*

\includegraphics[align=c,width=.05\textwidth]{images/check} \textcolor{green}{\textbf{Klar und kostenlosen Zugriffsprotokoll}}

\includegraphics[align=c,width=.05\textwidth]{images/check} \textcolor{green}{\textbf{Metadaten (Beschreibung der Daten) und Daten (Inhalt) sind abrufbar}}


##  Analyse

- **Interoperable**: *Wie leicht ist es, diese Daten zu verwenden?*

\includegraphics[align=c,width=.05\textwidth]{images/check} \textcolor{green}{\textbf{Formale und zugängliche Sprache}}

\includegraphics[align=c,width=.05\textwidth]{images/wrong} \textcolor{red}{\textbf{Verweise auf andere Daten}}

\includegraphics[align=c,width=.05\textwidth]{images/wavy} \textcolor{orange}{\textbf{Ermöglichte Integration mit anderen Datensätzen}}


##  Analyse

- **Reusable**: *Weiß ich, wie ich diese Daten wiederverwenden kann/darf?*

\includegraphics[align=c,width=.05\textwidth]{images/wrong} \textcolor{red}{\textbf{Detaillierter Herkunft}}

\includegraphics[align=c,width=.05\textwidth]{images/check} \textcolor{green}{\textbf{Klare und zugängliche Datennutzungs -lizenz}}

##  Analyse

- **Datenformat:**

\begin{center}

\includegraphics[align=c,width=.05\textwidth]{images/wavy} Aktuell = \textcolor{orange}{\textbf{Excel}}

\includegraphics[width=0.1\textwidth]{images/excel}

\includegraphics[align=c,width=.05\textwidth]{images/check} Optimal = \textcolor{green}{\textbf{CSV}}

\includegraphics[width=0.1\textwidth]{images/csv}

\end{center}

## Zusammenfassung Theorie
<!-- New content added to this slide VB -->

- Datenqualität umfasst viele verschiedene Aspekte

  + Nicht alle diese Aspekte könnten bei diesem Workshop angesprochen werden

- Heute: Besonderer Fokus auf der *Aufbereitung* von Datensätzen (Kontextunabhängig)

  + Insbesondere: Konformität und Verständlichkeit (NQDM)


# 2. Praxis

# Excel

## Was ist eine Excel-Datei?

- Tabelle, die mit Excel bearbeitet werden kann

- Komplexes Dateiformat

- Stärker Fokus auf Human-Readability (im Vergleich zu anderen Dateiformaten)

## Zu vermeiden in Excel

1. Überflüssige Text-Formatierung (insbesondere verbundene Zellen, leere Reihen, usw.)

  - Kann die Maschinenlesbarkeit der Tabelle beeinträchtigen 
  - Lieber effiziente Kategorisierung statt überbearbeitete Tabellen

## Zu vermeiden in Excel

\vspace{1cm}

\begin{center}
\includegraphics[align=c,width=.1\textwidth]{images/wrong}
\hspace{0.5cm}
\includegraphics[align=c,width=.8\textwidth]{images/pic5}
\end{center}

\scriptsize\textbf{Quelle}: Open Data Portal, "Eintrittspreisregelungen öffentlich geförderter Berliner Kultureinrichtungen"

## Zu vermeiden in Excel

\vspace{0.5cm}

\begin{center}
\includegraphics[align=c,width=.1\textwidth]{images/check}
\hspace{0.5cm}
\includegraphics[align=c,width=.8\textwidth]{images/pic6}
\end{center}

\scriptsize\textbf{Quelle}: Open Data Portal, "Eintrittspreisregelungen öffentlich geförderter Berliner Kultureinrichtungen"

## Zu vermeiden in Excel


- Aktive Formeln

  - Daten sollten nicht versehentlich vom Benutzer geändert werden


\begin{center}
\includegraphics[align=c,width=.1\textwidth]{images/wrong}
\hspace{0.5cm}
\includegraphics[align=c,width=.6\textwidth]{images/pic7}
\end{center}




## Auswertung Excel-Dateien

- **Vorteil**: Bessere Darstellungsmöglichkeiten

- **Nachteil**: Können schnell nicht-maschinenlesbar werden


# CSV

## Was ist ein CSV?

- Text-Datei

- Einfaches Dateiformat

- Werte werden mit einem Trennzeichen abgetrennt ("Comma Separated Values")

- Stärker Fokus auf Machine-Readability

## Was ist ein CSV?

- So sieht ein CSV aus:

\begin{center}
\includegraphics[align=c,width=1\textwidth]{images/pic29}
\end{center}

\scriptsize\textbf{Quelle}: Open Data Portal, "COVID-19 in Berlin, Verteilung in den Bezirken - Gesamtübersicht"

## Zu vermeiden in CSV
<!-- New content added to this slide VB -->


- Trennzeichen

  - Trennzeichen sollten nicht an anderen Stellen verwendet werden (z.B.: beim Trennzeichen "," sollte man "10.5" schreiben statt "10,5")



\begin{center}
\includegraphics[align=c,width=.1\textwidth]{images/wrong}
\hspace{0.5cm}
\includegraphics[align=c,width=.7\textwidth]{images/pic9_1}
\end{center}

\scriptsize\textbf{Quelle}: Open Data Portal, "COVID-19 Fälle im Land Berlin, Verteilung nach Altersgruppen" \textbf{(verändert)}



## Zu vermeiden in CSV
<!-- New content added to this slide VB -->


- Trennzeichen

  - Trennzeichen sollten nicht an anderen Stellen verwendet werden (z.B.: beim Trennzeichen "," sollte man "10.5" schreiben statt "10,5")

\begin{center}
\includegraphics[align=c,width=.1\textwidth]{images/check}
\hspace{0.5cm}
\includegraphics[align=c,width=.7\textwidth]{images/pic9_2}
\end{center}

\scriptsize\textbf{Quelle}: Open Data Portal, "COVID-19 Fälle im Land Berlin, Verteilung nach Altersgruppen"

## Zu vermeiden in CSV


- Text-Formatierung

  - Wird sowieso nicht gespeichert / angezeigt


\begin{center}
\includegraphics[align=c,width=.1\textwidth]{images/wrong}
\hspace{0.5cm}
\includegraphics[align=c,width=.8\textwidth]{images/pic10_1}
\end{center}

\scriptsize\textbf{Quelle}: Open Data Portal, "Liste der verbannten Bücher" \textbf{(verändert)}

## Zu vermeiden in CSV


- Text-Formatierung

  - Wird sowieso nicht gespeichert / angezeigt


\begin{center}
\includegraphics[align=c,width=.1\textwidth]{images/check}
\hspace{0.5cm}
\includegraphics[align=c,width=.8\textwidth]{images/pic10_2}
\end{center}

\scriptsize\textbf{Quelle}: Open Data Portal, "Liste der verbannten Bücher"



## Zu vermeiden in CSV

- Überschriften (außer Spaltennamen), Copyright-Hinweise, usw.


\begin{center}
\includegraphics[align=c,width=.1\textwidth]{images/wrong}
\hspace{0.5cm}
\includegraphics[align=c,width=.80\textwidth]{images/pic11}
\end{center}

\scriptsize\textbf{Quelle}: Der Bundeswahlleiter, "Wahl zum 19. Deutschen Bundestag"

## Zu vermeiden in CSV

- Überschriften (außer Spaltennamen), Copyright-Hinweise, usw.


\begin{center}
\includegraphics[align=c,width=.1\textwidth]{images/check}
\includegraphics[align=c,width=.90\textwidth]{images/pic30}
\end{center}

\scriptsize\textbf{Quelle}: Der Bundeswahlleiter, "Wahl zum 19. Deutschen Bundestag"




## Hinweise

- Zeichencodierung

   + Empfehlung: UTF-8 (die Defaultcodierung beim Speichern eines CSV in Excel)

   + Die Codierung sollte bewusst ausgewählt werden und dem Endnutzer kommuniziert (z.B. in den Metadaten des Datensatzes im Open-Data-Portal)


## Hinweise

- Zeichencodierung

   + Wenn ein Datensatz mit der "falschen" Codierung geöffnet wird, kommt es zu Probleme mit der Lesbarkeit des Datensatzes
   
      + *z.B.*:

\begin{center}
\includegraphics[width=.75\textwidth]{images/pic13}
\end{center}



## Hinweise

- Wie die Zeichencodierung eines CSV beim Importieren in Excel zu ändern

  + Fichier -> Importer **(Tori: we'll change this to German)**

     + Origine du fichier: UTF-8

\begin{center}
\includegraphics[width=.75\textwidth]{images/pic14}
\end{center}


## Auswertung CSV

- **Vorteil**: Am offensten

- **Nachteil**: Sehr einfache Darstellungsmöglichkeiten

# Formatentscheidung: Excel vs. CSV

## Wann sollte man was nutzen?

- In den meisten Fällen: CSVs

- Excel benutzen wenn...

  + es wichtig ist, dass die Tabellen lesbarer für Menschen sind (**aber denken Sie daran, dass die Tabelle maschinenlesabr bleiben muss!**)

  + mehrere Blättern nötig sind


# Andere Formate


## Daten Formate


+ **Nicht tabellarish**

  + JSON

  + GeoJSON

+ **Tabellarisch**

   + SAV

   + DTA

   + RData

## Daten Formate

+ JSON

  + "JavaScript Object Notation"

  + Nicht tabellarisch, mehr flexibel

\begin{center}
\includegraphics[width=.75\textwidth]{images/pic15}
\end{center}


## Daten Formate

+ GeoJSON

  + "Geographic JSON"

  + Geografische Daten

  + Basierend auf dem JSON-Format

\begin{center}
\includegraphics[width=.45\textwidth]{images/pic16}
\end{center}


## Daten Formate

+ SAV

  + SPSS Daten

+ DTA

  + Python Daten

+ RData

  + R Daten


# Häufige Probleme mit tabellarischen Datensätzen

## 5 Sachen zu überprüfen
<!-- test -->

1. Zahlen

2. Daten

3. Standorte

4. Tippfehler

5. Identifikationsnummer

<!-- Empty values / NAs? -->

## 1. Zahlen

+ **Für Ganzzahlen**: Keine Leerzeichen oder Kommata verwenden

\begin{center}
\includegraphics[align=c,width=.1\textwidth]{images/wrong}
\hspace{0.5cm}
\includegraphics[align=c,width=.25\textwidth]{images/pic22}
\hspace{0.5cm}    
\includegraphics[align=c,width=.1\textwidth]{images/check}
\hspace{0.5cm}
\includegraphics[align=c,width=.25\textwidth]{images/pic21}
\end{center}

<!-- https://daten.berlin.de/datensaetze/verbraucherpreisindex-im-land-berlin-und-brandenburg -->


## 1. Zahlen

+ **Für Dezimalzeichen**: Immer einen Punkt verwenden (0.1 vs. 0,1)

\begin{center}
\includegraphics[align=c,width=.1\textwidth]{images/wrong}
\hspace{0.5cm}
\includegraphics[align=c,width=.25\textwidth]{images/pic23}
\hspace{0.5cm}    
\includegraphics[align=c,width=.1\textwidth]{images/check}
\hspace{0.5cm}
\includegraphics[align=c,width=.25\textwidth]{images/pic24}
\end{center}

<!-- https://daten.berlin.de/datensaetze/verbraucherpreisindex-im-land-berlin-und-brandenburg -->


\center{\tiny{\textbf{Mehr Dazu}: NQDM: "Leitfaden für qualitativ hochwertige Daten und Metadaten", S. 24. https://www.nqdm-projekt.de/de/downloads/leitfaden} }


## 2. Daten

+ Empfehlung des NQDM: ISO-8601-Format nutzen

  + JJJJ-MM-TT (z.B.: 2020-09-17)
  
\begin{center}
\includegraphics[align=c,width=.1\textwidth]{images/wrong}
\hspace{0.5cm}
\includegraphics[align=c,width=.25\textwidth]{images/pic25}
\hspace{0.5cm}    
\includegraphics[align=c,width=.1\textwidth]{images/check}
\hspace{0.5cm}
\includegraphics[align=c,width=.25\textwidth]{images/pic26}
\end{center}

<!-- https://daten.berlin.de/datensaetze/berliner-stra%C3%9Fen-und-volksfeste-2020 -->


\center{\tiny{\textbf{Mehr Dazu}: NQDM: "Leitfaden für qualitativ hochwertige Daten und Metadaten", S. 20. https://www.nqdm-projekt.de/de/downloads/leitfaden} }


## 3. Standorte

Zwei Möglichkeiten:

1. **Koordinaten**

  + Die beste Wahl (am genausten)
  
  + RBS-Geocoder (vom Amt für Statistik)
  
## 3. Standorte

2. **Adressen**

  + Empfehlung: Straße, Hausnummer und PLZ trennen
  
\begin{center}
\includegraphics[align=c,width=.50\textwidth]{images/pic27}
\end{center}

<!-- https://daten.berlin.de/datensaetze/gedenktafel-datenbank-berlin-mitte-2 -->

## 3. Standorte

2. **Adressen**
  
  + Darauf beachten: Adressen möglichst einheitlich erfassen

     + zB.: "Straße" vs. "Str."

## 4. Tippfehler

+ Mit der Anwendung eines Filters in Excel kann man Tippfehler leicht identifizieren 

   + Données -> Filtre avancé -> Extraction sans doublon

<!-- German transaltion pending VB -->

\begin{center}
\includegraphics[width=0.5\textwidth]{images/pic19}
\end{center}
\vspace{-0.5cm}
\center\tiny\textbf{Quelle}: Open Data Portal, "Liste der verbannten Bücher"

+ Rechtschreibkorrektur in Excel aktivieren

## 4. Tippfehler

+ Technologiestiftung Tool zum Aufräumen eines CSV

\begin{center}
\includegraphics[align=c,width=.75\textwidth]{images/pic28}
\end{center}

https://lab.technologiestiftung-berlin.de/projects/csv-string-optimization/de/
  
## 5. ID Nummer

+ Für Datensätze, wo die Angaben eine Bezeichnung/ID-Nummer haben: diese Nummer sollte im Datensatz drin sein! 

    + z.B. Die Bezeichnungsnummer einer Schule

+ Wichtig um...

  + Änderungen zu verfolgen

  + Datensätze zusammenzuführen

## Das wichtigste von allen: Einheitlichkeit

+ Wählen Sie einen Standard aus - am besten einen von uns empofhlenen Standard - und **ziehen Sie diesen Standard konsequent durch**

# *Quiz*

## Schulbausanierung Sommer 2020

\begin{center}
\includegraphics[width=0.9\textwidth]{images/pic4}
\end{center}

## Fragen

 + In Excel, sortieren Sie die Eingaben nach Finanzierung. Merken Sie etwas, was verbessert sein könnte?

 + Schauen Sie sich die Addressen in der "Adresse" Spalte an. Was könnte hier optimiert werden?

 + Wie kann man den Datensatz zu einem CSV konvertieren und speichern?

## Analyse

 - **Finanzierung-Spalte**

    + Einheitlichkeit ist wichtig

    + Auf Typos achten!

\begin{center}
\includegraphics[width=0.55\textwidth]{images/quiz2}
\end{center}

## Analyse

 - **Adresse-Spalte**

    + "Straße" oder "Str."?

\begin{center}
\includegraphics[width=0.45\textwidth]{images/quiz2_2}
\end{center}

# 3. Beispiel

## Gieß den Kiez

\begin{center}
\includegraphics[width=.95\textwidth]{images/giez}
\end{center}

## Gieß den Kiez

\begin{center}
\includegraphics[width=.95\textwidth]{images/giez_2}
\end{center}

## Fehlende ID Nummer

+ **Ziel**:

  + Bewässerungsdaten von der Regierung in den Gieß den Kiez Datensatz hinzufügen

+ **Problem**:

  + Kein gemeinsame Identifikationsnummer zwischen:

    1. Bewässerungdaten von der Regierung

    2. Bewässerungdaten von Gieß den Kiez

<!-- Welche sind die Bewässerungsdaten von GdK? -->

## Versuch #1

+ **Methode**: ID aus verschiedenen Spalten generieren

   + Pflanzjahr + Standalter + Stammumfang + Stammdurchmesser + Baumhöhe + Kronendurchmesser + Sorte

\begin{center}
\includegraphics[width=.6\textwidth]{images/pic20}
\end{center}

+ **Problem**: Duplikate (i.e. Bäume mit identischen Charakteristiken im Datensazt)
